<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenSSL 自签证书详解 | CloudNative Operations</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="专注于云原生运维技术分享,Kubernetes,Prometheus，istio,envoy等技术文章">
    <meta name="CloudNative Operations" content="专注于云原生运维技术分享,致敬每个爱学习的你">
    <meta name="baidu-site-verification" content="code-UYHaqAD5D2">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.546f0649.css" as="style"><link rel="preload" href="/assets/js/app.1e215306.js" as="script"><link rel="preload" href="/assets/js/2.f3cfc96e.js" as="script"><link rel="preload" href="/assets/js/29.1ad8b1c1.js" as="script"><link rel="prefetch" href="/assets/js/10.e56199b8.js"><link rel="prefetch" href="/assets/js/11.2d5ecf24.js"><link rel="prefetch" href="/assets/js/12.dea116c0.js"><link rel="prefetch" href="/assets/js/13.1fa2caec.js"><link rel="prefetch" href="/assets/js/14.a5ba773e.js"><link rel="prefetch" href="/assets/js/15.b3e52fd6.js"><link rel="prefetch" href="/assets/js/16.33a07abe.js"><link rel="prefetch" href="/assets/js/17.f4c7d679.js"><link rel="prefetch" href="/assets/js/18.8277b4ef.js"><link rel="prefetch" href="/assets/js/19.3259b727.js"><link rel="prefetch" href="/assets/js/20.c9c5a00e.js"><link rel="prefetch" href="/assets/js/21.069ffb81.js"><link rel="prefetch" href="/assets/js/22.e1e62ac4.js"><link rel="prefetch" href="/assets/js/23.78d018da.js"><link rel="prefetch" href="/assets/js/24.3d9af872.js"><link rel="prefetch" href="/assets/js/25.899c4150.js"><link rel="prefetch" href="/assets/js/26.d33e81c4.js"><link rel="prefetch" href="/assets/js/27.c3f4e695.js"><link rel="prefetch" href="/assets/js/28.62525792.js"><link rel="prefetch" href="/assets/js/3.aef08317.js"><link rel="prefetch" href="/assets/js/30.b8d48f05.js"><link rel="prefetch" href="/assets/js/31.94d98463.js"><link rel="prefetch" href="/assets/js/32.302807da.js"><link rel="prefetch" href="/assets/js/33.9793268c.js"><link rel="prefetch" href="/assets/js/34.a2722a59.js"><link rel="prefetch" href="/assets/js/35.ef20d1ab.js"><link rel="prefetch" href="/assets/js/36.1a468a42.js"><link rel="prefetch" href="/assets/js/4.523f8496.js"><link rel="prefetch" href="/assets/js/5.ab2f819c.js"><link rel="prefetch" href="/assets/js/6.40e3ffa9.js"><link rel="prefetch" href="/assets/js/7.0b585a2a.js"><link rel="prefetch" href="/assets/js/8.81da17b7.js"><link rel="prefetch" href="/assets/js/9.2e129817.js">
    <link rel="stylesheet" href="/assets/css/0.styles.546f0649.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="CloudNative Operations" class="logo"> <span class="site-name can-hide">CloudNative Operations</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/books/" class="nav-link">书籍</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div> <a href="https://github.com/cf1998/kubernetes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://kubesre.com/img/EB-logo.png"> <div class="blogger-info"><h3>船长</h3> <span>CloudNative Operations</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/books/" class="nav-link">书籍</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div> <a href="https://github.com/cf1998/kubernetes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>OpenSSL 自签证书详解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/opens1/#数字证书的基本概念" class="sidebar-link">数字证书的基本概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/opens1/#数字证书的标准" class="sidebar-link">数字证书的标准</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#数字证书的常见格式" class="sidebar-link">数字证书的常见格式</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#数字证书和公钥的关系" class="sidebar-link">数字证书和公钥的关系</a></li></ul></li><li><a href="/pages/opens1/#openssl-自签ssl过程" class="sidebar-link">openssl 自签SSL过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/opens1/#初始化证书存放目录结构和文件" class="sidebar-link">初始化证书存放目录结构和文件</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#制作ca根证书" class="sidebar-link">制作CA根证书</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#制作代理ca证书-中间ca" class="sidebar-link">制作代理CA证书(中间CA)</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#生成服务端证书" class="sidebar-link">生成服务端证书</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#生成客户端证书" class="sidebar-link">生成客户端证书</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#nginx服务端配置-服务端证书" class="sidebar-link">Nginx服务端配置(服务端证书)</a></li><li class="sidebar-sub-header"><a href="/pages/opens1/#通过curl命令验证双向认证" class="sidebar-link">通过Curl命令验证双向认证</a></li></ul></li><li><a href="/pages/opens1/#openssl-自签-ecc-证书" class="sidebar-link">openssl 自签 ECC 证书</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-9354336437522810"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><!----> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>船长</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2021-12-21</a></div> <div title="分类" class="date iconfont icon-wenjian" data-v-1cd794fe><a href="/categories/?category=Linux" data-v-1cd794fe>Linux </a></div></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          OpenSSL 自签证书详解
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-9354336437522810"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><p>openssl是一个功能丰富且自包含的开源安全工具箱。它提供的主要功能有：SSL协议实现(包括SSLv2、SSLv3和TLSv1)、大量软算法(对称/非对称/摘要)、大数运算、非对称算法密钥生成、ASN.1编解码库、证书请求(PKCS10)编解码、数字证书编解码、CRL编解码、OCSP协议、数字证书验证、PKCS7标准实现和PKCS12个人数字证书格式实现等功能。</p> <h2 id="数字证书的基本概念"><a href="#数字证书的基本概念" class="header-anchor">#</a> 数字证书的基本概念</h2> <h3 id="数字证书的标准"><a href="#数字证书的标准" class="header-anchor">#</a> 数字证书的标准</h3> <ul><li><strong>X.509版本号</strong>：指出该证书使用了哪种版本的X.509标准，版本号会影响证书中的一些特定信息</li> <li><strong>序列号</strong>：由CA给予每一个证书分配的唯一的数字型编号，当证书被取消时，实际上是将此证书序列号放入由CA签发的CRL（Certificate Revocation List证书作废表，或证书黑名单表）中。这也是序列号唯一的原因</li> <li><strong>签名算法标识符</strong>：用来指定CA签署证书时所使用的签名算法，常见算法如RSA</li> <li><strong>签发者信息</strong>：颁发证书的实体的 X.500 名称信息。它通常为一个 CA</li> <li><strong>证书的有效期</strong>：证书起始日期和时间以及终止日期和时间；指明证书在这两个时间内有效。</li> <li><strong>主题信息</strong>：证书持有人唯一的标识，在 Internet上应该是唯一的</li> <li><strong>发布者的数字签名</strong>：这是使用发布者私钥生成的签名，以确保这个证书在发放之后没有被撰改过。</li> <li><strong>证书的公钥</strong>：包括证书的公钥、算法(指明密钥属于哪种密码系统)的标识符和其他相关的密钥参数</li></ul> <h3 id="数字证书的常见格式"><a href="#数字证书的常见格式" class="header-anchor">#</a> 数字证书的常见格式</h3> <ul><li><strong>CSR</strong>：证书请求文件，这个并不是证书，而是向证书颁发机构获得签名证书的申请文件</li> <li><strong>CER</strong>：存放证书文件可以是二进制编码或者BASE64编码</li> <li><strong>CRT</strong>：证书可以是DER编码，也可以是PEM编码，在linux系统中比较常见</li> <li><strong>pem</strong>：该编码格式在RFC1421中定义，但他也同样广泛运用于密钥管理，实质上是 Base64 编码的二进制内容</li> <li><strong>DER</strong>：用于二进制DER编码的证书。这些证书也可以用CER或者CRT作为扩展名</li> <li><strong>JKS</strong>：java的密钥存储文件,二进制格式,是一种 Java 特定的密钥文件格式， JKS的密钥库和私钥可以用不同的密码进行保护</li> <li><strong>p12/PFX</strong>：包含所有私钥、公钥和证书。其以二进制格式存储，也称为 PFX 文件，在windows中可以直接导入到密钥区，密钥库和私钥用相同密码进行保护</li></ul> <h3 id="数字证书和公钥的关系"><a href="#数字证书和公钥的关系" class="header-anchor">#</a> <strong>数字证书和公钥的关系</strong></h3> <p>数字证书是经过权威机构（CA）认证的公钥，通过查看数字证书，可以知道该证书是由那家权威机构签发的，证书使用人的信息，使用人的公钥。它有以下特点：</p> <p>1、由专门的机构签发的数字证书才安全有效。</p> <p>2、签发数字证书是收费的。</p> <p>3、不会被冒充，安全可信。</p> <p>4、数字证书有使用期限，过了使用期限，证书变为不可用。CA也可以在试用期内，对证书进行作废操作。</p> <h2 id="openssl-自签ssl过程"><a href="#openssl-自签ssl过程" class="header-anchor">#</a> openssl 自签SSL过程</h2> <h3 id="初始化证书存放目录结构和文件"><a href="#初始化证书存放目录结构和文件" class="header-anchor">#</a> 初始化证书存放目录结构和文件</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">mkdir</span> certs crl csr newcerts private
$ <span class="token builtin class-name">echo</span> <span class="token number">1000</span> <span class="token operator">&gt;</span> crlnumber <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token number">1000</span> <span class="token operator">&gt;</span> serial <span class="token operator">&amp;&amp;</span> <span class="token function">touch</span> index.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>注解：</p> <ul><li>private：  存放CA证书的私钥</li> <li>certs:      存放CA证书</li> <li>netcerts：  存放新生成的服务端或客户端证书，一般以序列号命名</li> <li>serial:     序列号，需给定初始值，可随意设置为01，1000等</li> <li>index.txt:   文件数据库，签发证书后会更新该数据库</li></ul> <h3 id="制作ca根证书"><a href="#制作ca根证书" class="header-anchor">#</a> 制作CA根证书</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 生成CA根证书私钥：为保证安全，生成一个4096位的私钥，并使用CNs方式加密</span>
$ openssl genrsa -CNs256 -out private/rootca.key <span class="token number">4096</span>  
Generating RSA private key, <span class="token number">4096</span> bit long modulus
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>++
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>++
e is <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
Enter pass phrase <span class="token keyword">for</span> private/rootca.key:      （输入CA私钥保护密码）
Verifying - Enter pass phrase <span class="token keyword">for</span> private/rootca.key:  （输入确认CA私钥保护密码）
 
<span class="token comment"># 生成自签名的CA根证书</span>
$ openssl req -config openssl.cnf -new -x509 -days <span class="token number">3650</span> -sha256 -extensions v3_ca -key private/rootca.key -out certs/rootca.cer -subj <span class="token string">&quot;/C=CN/L=F/O=kubesre/OU=ACS/CN=*.kubesre.com&quot;</span>
Enter pass phrase <span class="token keyword">for</span> private/rootca.key:  <span class="token punctuation">(</span>输入CA私钥保护密码<span class="token punctuation">)</span>
 
<span class="token comment"># 查看证书内容, 以确保证书生成正确</span>
 
$ openssl x509 -noout -text -in certs/rootca.cer
Certificate:
    Data:
        Version: <span class="token number">3</span> <span class="token punctuation">(</span>0x2<span class="token punctuation">)</span>
        Serial Number:
            f8:a5:89:11:71:df:45:d1
    Signature Algorithm: sha256WithRSCNncryption
        Issuer: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>*.kubesre.com
        Validity
            Not Before: Dec <span class="token number">10</span> 06:43:40 <span class="token number">2020</span> GMT
            Not After <span class="token builtin class-name">:</span> Dec  <span class="token number">8</span> 06:43:40 <span class="token number">2030</span> GMT
        Subject: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>*.kubesre.com
        Subject Public Key Info:
            Public Key Algorithm: rsCNncryption
                Public-Key: <span class="token punctuation">(</span><span class="token number">4096</span> bit<span class="token punctuation">)</span>
                Modulus:
                    00:ba:1e:a4:92:bf:25:3d:96:be:0e:af:65:a5:f8:
                    f0:a9:bc:09:4c:92:af:9a:f4:4b:df:87:2f:a6:56:
                    d7:4d:4a:28:d1:85:34:58:86:f7:79:30:8c:b2:71:
                    1f:1c:80:c3:b0:cd:6a:05:b4:e9:8f:8f:3e:eb:76:
                    8b:2e:66:c7:37:a6:d3:fd:be:23:f4:16:ad:02:ff:
                    7d:21:a1:ab:f0:39:15:d5:6c:93:a3:89:65:5b:84:
                    0c:e0:30:fe:b3:e4:f6:7f:42:d9:95:04:d8:23:d2:
                    2a:c1:63:e2:3c:e2:6b:f7:84:8b:bd:f3:c5:2c:7b:
                    2a:03:7d:7a:d7:93:b0:20:59:ff:64:2b:84:ac:09:
                    1d:05:35:2c:68:5a:90:42:ba:2a:54:d5:1b:0f:ec:
                    <span class="token number">93</span>:78:11:85:dc:e0:b5:60:68:46:c4:be:f3:05:b4:
                    ca:0b:bf:14:1f:a1:be:63:99:0d:f7:a6:90:b5:50:
                    c8:b2:c9:69:8b:31:e2:f0:b9:ab:62:a3:2b:1b:16:
                    <span class="token number">70</span>:1c:36:f3:79:ab:b4:42:6b:83:8d:f7:d0:8d:d7:
                    eb:a6:38:50:df:79:57:c0:eb:6c:b0:71:e3:c0:af:
                    7e:01:83:2e:77:64:b0:80:89:68:82:16:56:0d:69:
                    <span class="token number">30</span>:71:cc:2d:d6:b2:ef:29:c3:e9:46:7c:8e:bd:82:
                    8f:a9:8c:d0:77:91:1d:7c:9e:d6:18:a8:e8:87:16:
                    ff:d2:b0:3d:e5:9a:0a:6a:c7:52:f4:ce:95:11:59:
                    ea:ca:13:f8:4c:55:25:f1:12:2d:93:d6:2a:82:5c:
                    bf:ca:43:98:3f:ee:38:6a:af:a2:14:7b:61:00:ec:
                    <span class="token number">10</span>:f2:e3:4a:4f:8d:82:5c:9c:2d:ce:88:29:03:b9:
                    07:77:f6:46:b7:49:ec:c8:e3:13:60:af:a8:f5:a8:
                    CN:08:57:b3:b9:99:CN:e7:68:2c:9a:e3:ce:ed:7b:
                    f6:a8:a5:2a:74:73:d6:29:a4:3e:c6:e7:14:e9:4c:
                    <span class="token number">57</span>:b8:d4:91:43:2b:39:5d:7d:6e:34:f4:07:f7:95:
                    b6:7f:ec:9e:34:48:29:20:6f:aa:48:30:5f:dd:f3:
                    3a:20:cc:08:d1:4a:8e:d0:ba:60:d5:0a:4d:CN:23:
                    ed:05:51:88:2d:a9:37:51:54:c3:19:b9:29:ca:e2:
                    <span class="token number">91</span>:ad:1e:12:36:cd:9b:32:79:62:54:16:78:69:1c:
                    6e:4d:5a:56:a3:da:b2:dd:ac:be:ca:cc:87:ff:97:
                    <span class="token number">76</span>:a5:6d:b9:a8:1f:88:3a:3a:6d:b0:b8:54:17:bc:
                    <span class="token number">92</span>:4d:d6:80:4c:06:48:7e:19:e3:51:d1:a3:5a:0b:
                    7f:66:06:e7:6b:c2:b3:73:89:3d:bb:7c:1a:5d:31:
                    ce:ed:71
                Exponent: <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                F4:DD:78:54:58:68:52:30:88:C1:AD:07:43:BD:14:2D:2D:09:E5:D1
            X509v3 Authority Key Identifier:
                keyid:F4:DD:78:54:58:68:52:30:88:C1:AD:07:43:BD:14:2D:2D:09:E5:D1
 
            X509v3 Basic Constraints: critical
                CA:TRUE
    Signature Algorithm: sha256WithRSCNncryption
         <span class="token number">63</span>:52:0c:6e:2d:3c:54:1f:d1:aa:88:43:4f:00:04:2e:b7:85:
         d8:15:cd:5e:0f:8c:39:e6:80:69:1e:f6:18:f7:5c:a1:f6:e1:
         <span class="token number">52</span>:ed:c1:ce:89:30:bc:be:cf:22:b3:bb:9b:80:b6:de:6e:49:
         <span class="token number">47</span>:ec:80:f4:90:11:93:da:59:9d:1f:e9:b0:70:dc:50:74:36:
         7e:c8:03:bf:2f:84:50:c1:a0:1c:4e:07:d6:cd:87:a7:b6:35:
         <span class="token number">35</span>:85:90:9b:72:8b:35:42:cd:82:9a:b6:CN:cd:c6:7d:23:1d:
         d8:be:91:65:93:78:ee:e9:72:0e:8d:6f:cc:7c:4a:CN:d5:a6:
         a4:0a:f1:b4:cd:c9:29:fb:81:50:58:8c:01:cb:c0:65:a1:61:
         <span class="token number">46</span>:9e:53:fc:5d:3e:46:5d:b1:b3:49:67:43:3e:80:9f:90:dc:
         4a:e1:04:82:e5:4f:11:85:cc:f4:11:82:b0:b2:8f:e0:63:bc:
         b6:7f:14:c7:46:f3:84:a7:9b:d5:ca:3e:d7:1d:63:fd:64:4b:
         <span class="token number">31</span>:3b:b1:69:d2:c8:71:e8:19:d6:6f:5b:21:53:1c:48:65:89:
         <span class="token number">95</span>:c7:fa:be:b4:1a:42:67:8a:ed:d8:a4:13:a1:39:31:c0:80:
         2b:c3:26:05:15:76:cb:7c:52:8a:db:3b:5a:51:70:68:40:ed:
         <span class="token number">20</span>:6b:ef:ef:86:a4:87:40:ff:39:9e:c0:b2:cf:2d:75:44:b8:
         1f:ec:91:e8:06:d2:2d:26:10:e4:04:02:3e:09:96:92:db:ec:
         f4:80:e3:5c:dc:f8:fe:ed:09:b4:64:e2:73:1d:db:7d:68:f8:
         <span class="token number">21</span>:41:a8:5f:5b:4c:66:4f:71:d5:b1:8f:ef:8e:80:91:b8:cb:
         a0:ab:dc:9a:6b:e3:7a:12:a0:f6:80:7c:2e:51:c0:45:4a:eb:
         f6:78:2d:ff:6a:61:bc:7c:6a:0c:6e:4d:48:0e:fa:5c:84:24:
         1b:47:bf:24:be:93:56:6c:f1:15:ad:b7:f0:3d:73:13:d3:ea:
         da:bb:55:88:5f:9a:37:a4:3f:da:75:1e:cb:bd:7f:33:51:32:
         <span class="token number">42</span>:b2:f8:0c:63:c6:c6:4c:56:70:0a:a6:31:f0:f2:22:cf:9d:
         fe:78:53:92:2d:56:b9:0a:e2:bd:cd:82:f8:8b:35:29:fc:61:
         3c:a6:18:3e:f5:a4:da:aa:5b:fd:aa:15:91:91:b7:d3:89:f9:
         c0:b3:f9:f1:22:f8:a6:00:05:44:bf:2b:d6:af:21:98:bd:a3:
         <span class="token number">39</span>:b2:95:55:e2:f5:28:d9:cf:47:ec:39:12:0a:5e:bf:6d:f0:
         e5:dd:5c:26:53:f5:b9:1f:58:22:3f:ba:60:b6:48:49:98:82:
         ab:ec:4a:99:86:b9:21:28
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br></div></div><h3 id="制作代理ca证书-中间ca"><a href="#制作代理ca证书-中间ca" class="header-anchor">#</a> 制作代理CA证书(中间CA)</h3> <p>制作代理CA证书不是必须的，这里之所以要多次一步，是因为：</p> <ol><li>根证书的安全必须得到充分的保证</li></ol> <p>​    2.在实现商业逻辑中，代理CA的存在也是相当普遍</p> <p>用代理CA签发客户端证书的话，在服务端的配置需要特别注意，以nignx为例：必须设定ssl_verify_depth 2; 即客户端证书链的验证深度, 默认值为1; 因为代理CA之上还有根CA, 所以这里要设置为2, 否则无法校验通过</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 在生成代理CA证书私钥: 同样适用4096位, 不加密了</span>
$ openssl genrsa -out private/intermediateca.key <span class="token number">4096</span>   
<span class="token comment"># 在生成签发请求</span>
$ openssl req -new -key private/intermediateca.key -out csr/intermediateca.csr -subj <span class="token string">&quot;/C=CN/L=shanghai/O=kubesre/OU=ACS/CN=Pty Intermediateca CA&quot;</span>
<span class="token comment"># 用CA根证书签发该代理CA证书请求</span>
$ openssl x509 -req -extfile openssl.cnf -extensions v3_ca -days <span class="token number">3600</span> -sha256 -CA certs/rootca.cer -CAkey private/rootca.key -CAcreateserial -CAserial serial -in csr/intermediateca.csr -out certs/intermediateca.cer
Signature ok
<span class="token assign-left variable">subject</span><span class="token operator">=</span>/C<span class="token operator">=</span>CN/L<span class="token operator">=</span>shanghai/O<span class="token operator">=</span>kubesre/OU<span class="token operator">=</span>ACS/CN<span class="token operator">=</span>Pty Intermediateca CA
Getting CA Private Key
Enter pass phrase <span class="token keyword">for</span> private/rootca.key: <span class="token punctuation">(</span>输入CA私钥保护密码<span class="token punctuation">)</span>
 
 
<span class="token comment"># 查看代理CA证书内容, 以确保证书生成正确</span>
$ openssl x509 -noout -text -in certs/intermediateca.cer
Certificate:
    Data:
        Version: <span class="token number">3</span> <span class="token punctuation">(</span>0x2<span class="token punctuation">)</span>
        Serial Number: <span class="token number">4097</span> <span class="token punctuation">(</span>0x1001<span class="token punctuation">)</span>
    Signature Algorithm: sha256WithRSCNncryption
        Issuer: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>*.kubesre.com
        Validity
            Not Before: Dec <span class="token number">10</span> 06:55:30 <span class="token number">2020</span> GMT
            Not After <span class="token builtin class-name">:</span> Oct <span class="token number">19</span> 06:55:30 <span class="token number">2030</span> GMT
        Subject: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>Pty Intermediateca CA
        Subject Public Key Info:
            Public Key Algorithm: rsCNncryption
                Public-Key: <span class="token punctuation">(</span><span class="token number">4096</span> bit<span class="token punctuation">)</span>
                Modulus:
                    00:b2:2d:c6:2e:3a:f0:5a:4b:00:c1:d0:6b:0f:44:
                    <span class="token number">83</span>:3d:9b:3d:9f:c5:41:f8:e6:f5:20:a5:26:61:ac:
                    cc:55:33:14:76:96:6a:a2:4c:a7:37:bf:47:1f:9d:
                    <span class="token number">54</span>:41:83:3a:2a:9e:8f:b0:5f:d4:38:a5:a5:1d:89:
                    ea:14:c6:00:b4:3d:11:9e:31:42:a4:c8:5e:32:7b:
                    00:36:6a:d6:bf:c9:c6:04:e7:1b:2d:33:ea:dd:54:
                    <span class="token number">78</span>:01:aa:dd:a5:21:fc:4f:ce:68:02:d4:43:3b:ea:
                    a9:80:19:2c:e7:5a:e9:dc:1a:4a:74:47:1f:69:d0:
                    <span class="token number">17</span>:43:a7:c7:03:7e:a8:6a:94:f5:46:7b:5a:e0:93:
                    c4:b4:7f:dd:56:76:71:09:de:73:57:5d:33:e4:90:
                    fe:ff:7c:a7:77:0c:7c:37:83:87:a4:3a:7a:ec:a3:
                    <span class="token number">64</span>:6d:90:16:9b:cf:77:38:05:f8:e8:98:d8:07:42:
                    aa:5e:6a:f5:3c:fb:cb:86:51:b9:d2:30:a4:2c:9a:
                    5e:fe:07:48:6e:14:43:77:87:d3:b9:52:2f:5b:ef:
                    a5:e9:6c:3b:0a:c9:c7:aa:6e:db:9b:5e:4a:f3:c4:
                    a5:73:0b:77:95:c8:57:ba:7b:b0:f1:CN:b4:b1:71:
                    f9:e1:61:12:7f:5b:1e:21:87:cc:ca:c0:f4:bf:c3:
                    6c:41:3a:67:09:c9:92:b8:7e:7c:30:00:1b:d3:02:
                    <span class="token number">27</span>:da:ec:02:dd:6a:b3:6c:22:7e:34:af:a2:37:ff:
                    <span class="token number">18</span>:91:e5:c3:22:ca:31:80:73:8e:b8:99:66:6f:b3:
                    6b:23:a5:2d:83:6d:17:fe:85:89:aa:76:55:dd:86:
                    06:60:f1:2e:9b:8c:84:b8:15:3d:d8:d8:60:44:34:
                    bf:ac:45:d0:4c:5f:50:3a:57:78:7e:87:6c:17:bd:
                    <span class="token number">34</span>:CN:53:ff:98:96:f7:c0:38:1b:49:ef:22:92:26:
                    b8:73:8b:a8:89:f3:55:c9:61:7c:88:93:8d:c8:77:
                    <span class="token number">80</span>:af:e8:1e:94:60:4e:8a:94:27:72:e4:6c:31:01:
                    e6:06:81:80:68:3e:99:b0:86:53:22:91:49:c7:88:
                    <span class="token number">10</span>:62:8a:f3:5b:ba:a0:1d:47:c6:cc:35:8c:65:27:
                    de:a0:96:fa:1c:54:3b:52:80:35:af:74:8a:ec:56:
                    aa:fd:6b:06:2d:64:c1:e0:ee:36:ba:10:af:e3:64:
                    7b:4c:50:76:40:54:b9:df:1e:d8:67:e7:fc:e2:49:
                    <span class="token number">78</span>:48:57:96:17:91:1d:52:cb:8b:a0:f3:3b:27:98:
                    0c:f5:dc:1e:97:cc:21:0f:14:4a:2e:53:d6:fb:aa:
                    7b:63:8f:14:95:2b:b4:9c:97:39:3b:7e:57:26:12:
                    <span class="token number">68</span>:af:03
                Exponent: <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                ED:7F:54:BD:21:E8:69:CF:0F:3A:06:8C:CE:A4:B9:33:8C:94:F6:2C
            X509v3 Authority Key Identifier:
                keyid:F4:DD:78:54:58:68:52:30:88:C1:AD:07:43:BD:14:2D:2D:09:E5:D1
 
            X509v3 Basic Constraints: critical
                CA:TRUE
    Signature Algorithm: sha256WithRSCNncryption
         <span class="token number">90</span>:3f:28:9d:8b:e7:45:46:91:b7:24:6e:b0:d7:85:d3:c2:f3:
         ee:05:55:d9:d9:9f:41:05:aa:5c:4d:2c:ca:01:3d:f8:40:1d:
         b3:c9:84:c2:47:1c:05:61:c9:46:ac:dd:18:24:fa:5b:69:57:
         <span class="token number">38</span>:72:7a:16:a6:b7:a7:16:65:f8:84:62:1b:41:34:13:3b:c4:
         1b:50:a1:44:35:d8:cf:cd:02:f3:a3:d9:29:6e:4b:61:83:f9:
         7f:1a:e0:74:02:8c:5e:02:31:8c:28:b7:10:de:63:c7:86:08:
         <span class="token number">31</span>:5c:2a:c0:83:4d:01:8b:70:59:69:99:40:be:54:ce:d6:c6:
         c3:b9:4b:1f:84:e1:c1:fa:5c:07:ba:74:66:f0:66:db:90:10:
         be:d8:3d:a7:cb:e1:33:e3:7c:10:a8:5d:9b:73:96:51:87:41:
         e9:2f:8b:e9:88:22:fb:f7:23:7d:e5:b7:04:dc:39:f9:05:80:
         4a:21:07:98:f1:49:49:77:b7:a2:33:af:37:aa:10:f3:f6:47:
         0d:fb:e3:29:bb:0f:5a:ad:0b:a1:d0:41:26:80:9b:20:4c:b8:
         d8:81:40:30:18:66:b6:1c:92:b2:7b:0c:f0:1b:aa:1f:ef:3a:
         <span class="token number">40</span>:21:a6:3a:13:fa:26:25:f5:08:98:f6:d9:11:ab:f6:9a:4e:
         8b:c0:e2:eb:2a:85:77:da:fb:c0:53:b0:d5:7c:a9:7b:6c:93:
         be:46:1e:92:92:b4:7d:2f:39:f0:86:8a:67:3c:b1:b5:60:3d:
         ca:43:bd:b5:86:15:6e:10:60:d4:af:b4:99:83:b5:52:2a:3b:
         <span class="token number">27</span>:0d:29:9a:e3:97:c5:15:e3:2b:f7:c0:68:79:93:8d:e8:53:
         0f:cd:1d:cf:0c:23:1c:23:d2:e0:ee:32:1c:08:55:7d:ed:e5:
         01:1a:ba:40:1d:c8:b1:51:2d:85:0c:5d:a1:30:80:c8:36:5c:
         <span class="token number">61</span>:d5:e4:35:97:07:46:00:17:e4:ee:2b:f2:e6:77:3d:75:62:
         <span class="token number">13</span>:a2:5b:63:dc:6c:ed:21:b3:c0:84:06:37:39:c7:f9:65:48:
         f0:bb:ba:ab:a1:a7:ce:a0:31:80:99:5e:ce:24:37:1b:05:d5:
         4f:41:f9:65:e4:c4:a6:97:23:19:c8:b2:41:86:bb:71:bb:b4:
         e0:30:e4:ba:9a:65:76:58:0d:29:03:ad:74:ed:e0:12:f5:f9:
         <span class="token number">23</span>:65:21:5f:f0:db:b6:4f:9f:1b:2c:b8:13:ff:84:95:34:1c:
         <span class="token number">31</span>:06:17:50:bf:61:cb:6a:99:74:b5:35:b5:e1:9d:e4:04:53:
         <span class="token number">52</span>:95:fa:d8:e4:19:bc:3e:f3:1c:0b:ad:d4:a8:f6:c2:16:cc:
         <span class="token number">55</span>:04:01:a3:b7:af:06:3b
 
 
<span class="token comment"># 用根证书校验代理CA证书, 确认是否通过</span>
$ openssl verify -CAfile certs/rootca.cer certs/intermediateca.cer    
certs/intermediateca.cer: OK
 
<span class="token comment"># 合并证书链, 在校验代理CA签发的证书时需要使用证书链验证</span>
 
$ <span class="token function">cat</span> certs/intermediateca.cer certs/rootca.cer <span class="token operator">&gt;</span> certs/intermediateca-chain.cer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br></div></div><h3 id="生成服务端证书"><a href="#生成服务端证书" class="header-anchor">#</a> 生成服务端证书</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 创建基于域名的文件夹， 暂且放在newcerts目录下吧</span>
$ <span class="token function">mkdir</span> newcerts/www.kubesre.com
 
 
<span class="token comment"># 生成服务端证书私钥: 期限相对较短, 所以用2048位足以</span>
$  openssl genrsa -out newcerts/www.kubesre.com/server.key <span class="token number">2048</span>
<span class="token comment"># 生成签发请求</span>
$ openssl req -new -key newcerts/www.kubesre.com/server.key -out newcerts/www.kubesre.com/server.csr -subj <span class="token string">&quot;/C=CN/L=shanghai/O=kubesre/OU=ACS/CN=www.kubesre.com&quot;</span>
<span class="token comment"># 用CA证书签发证书</span>
$ openssl x509 -req -extfile openssl.cnf -extensions usr_cert -days <span class="token number">365</span> -sha256 -CA certs/rootca.cer -CAkey private/rootca.key -CAserial serial -in newcerts/www.kubesre.com/server.csr -out newcerts/www.kubesre.com/server.cer
Signature ok
<span class="token assign-left variable">subject</span><span class="token operator">=</span>/C<span class="token operator">=</span>CN/L<span class="token operator">=</span>shanghai/O<span class="token operator">=</span>kubesre/OU<span class="token operator">=</span>ACS/CN<span class="token operator">=</span>www.kubesre.com
Getting CA Private Key
Enter pass phrase <span class="token keyword">for</span> private/rootca.key:  <span class="token punctuation">(</span>输入CA私钥保护密码<span class="token punctuation">)</span>
 
 
<span class="token comment"># 查看生成的证书内容</span>
$ openssl x509 -noout -text -in newcerts/www.kubesre.com/server.cer
Certificate:
    Data:
        Version: <span class="token number">3</span> <span class="token punctuation">(</span>0x2<span class="token punctuation">)</span>
        Serial Number: <span class="token number">4098</span> <span class="token punctuation">(</span>0x1002<span class="token punctuation">)</span>
    Signature Algorithm: sha256WithRSCNncryption
        Issuer: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>*.kubesre.com
        Validity
            Not Before: Dec <span class="token number">10</span> 07:09:35 <span class="token number">2020</span> GMT
            Not After <span class="token builtin class-name">:</span> Dec <span class="token number">10</span> 07:09:35 <span class="token number">2021</span> GMT
        Subject: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>www.kubesre.com
        Subject Public Key Info:
            Public Key Algorithm: rsCNncryption
                Public-Key: <span class="token punctuation">(</span><span class="token number">2048</span> bit<span class="token punctuation">)</span>
                Modulus:
                    00:b4:ec:81:9b:e7:f2:6f:51:35:2a:de:5a:0e:11:
                    f2:d8:c6:3f:b2:d0:0a:b9:ad:84:ba:7f:8d:60:de:
                    <span class="token number">14</span>:b1:18:55:a0:1f:f5:85:4d:2b:c7:b7:2d:4e:6f:
                    6a:b3:64:b6:b0:54:e7:f3:a8:c4:30:a6:b9:f4:f2:
                    <span class="token number">67</span>:b5:d2:d1:c7:3b:9b:3a:34:32:23:6b:66:fc:f4:
                    a1:81:b0:f0:76:ee:cd:85:69:c9:f9:b0:1d:d3:0c:
                    de:c9:f5:de:54:63:a0:f8:c2:57:c1:7f:0e:5c:77:
                    <span class="token number">80</span>:2a:38:39:c2:3c:d0:cc:96:3c:16:32:9c:d5:72:
                    <span class="token number">92</span>:d0:f6:3c:53:05:62:f7:ed:aa:b4:2c:ac:27:dd:
                    2d:7e:6b:b2:57:3e:e7:59:07:96:a6:e2:cf:f7:34:
                    <span class="token number">85</span>:5b:4e:3e:b1:47:f9:bd:49:24:01:2e:3c:00:18:
                    <span class="token number">46</span>:8f:b3:09:df:ca:71:b3:d3:13:68:19:21:9d:3e:
                    9d:7b:89:91:fa:a0:80:dd:6b:34:87:ea:58:6e:1f:
                    9f:32:10:a2:ba:ca:74:84:0a:f7:44:c5:4a:58:fc:
                    ba:ef:67:76:44:6f:71:b3:67:eb:7b:7d:e7:cc:eb:
                    fb:a7:55:88:a9:78:1a:9d:96:00:7b:ea:6c:6d:0d:
                    4f:b1:4b:83:4c:30:c4:a1:de:47:1b:47:84:65:bf:
                    <span class="token number">74</span>:ff
                Exponent: <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
        X509v3 extensions:
            X509v3 Basic Constraints:
                CA:FALSE
            Netscape Comment:
                OpenSSL Generated Certificate
            X509v3 Subject Key Identifier:
                <span class="token number">82</span>:9D:C2:70:F7:E7:58:77:AB:0A:3A:EB:FD:60:F9:9C:FA:A3:00:EB
            X509v3 Authority Key Identifier:
                keyid:F4:DD:78:54:58:68:52:30:88:C1:AD:07:43:BD:14:2D:2D:09:E5:D1
 
    Signature Algorithm: sha256WithRSCNncryption
         <span class="token number">24</span>:3d:13:a1:90:ea:93:e7:12:2f:b7:d8:ea:ec:b1:5e:95:d4:
         <span class="token number">23</span>:8a:b2:bd:45:2a:6c:79:a8:c3:96:1d:2d:c7:b9:54:e0:a4:
         0a:27:3c:d2:4d:2b:3c:d5:fe:e7:b3:35:5f:72:ee:50:87:a6:
         e3:1c:00:43:3f:8e:e0:16:ab:c4:be:95:24:33:f9:31:df:b4:
         <span class="token number">92</span>:33:68:10:68:4f:ce:69:ff:26:d7:6a:dc:01:99:16:59:58:
         9d:99:52:19:a3:e5:ad:82:72:6e:0b:2a:86:6b:4d:88:2d:f2:
         <span class="token number">57</span>:a3:cc:d3:42:9a:CN:ab:af:ea:64:2b:b4:fe:36:a3:60:65:
         <span class="token number">40</span>:c9:47:4e:ed:e9:4f:92:36:e0:35:ef:96:b3:5c:59:CN:7a:
         <span class="token number">65</span>:a9:9f:ba:c8:d9:04:a7:4c:ce:26:fd:75:c9:ec:53:f2:1b:
         <span class="token number">40</span>:ed:60:2d:64:25:81:7a:79:3b:68:22:fd:89:83:14:91:8f:
         be:9b:fb:2d:bf:68:5a:2f:c2:1d:ab:00:70:0b:2e:62:ba:c8:
         06:4d:d5:ef:7a:a2:3f:75:12:7c:9d:ff:11:74:cc:08:25:d7:
         2b:04:ec:ea:ce:4c:01:d4:dd:5b:65:6b:b1:ad:27:ab:2e:4a:
         7c:43:c1:2c:91:05:2b:68:dd:7b:a9:8b:a0:d8:ba:4b:94:14:
         b8:f4:84:e3:7c:08:5b:66:28:4d:48:7a:5a:e7:d4:01:50:dc:
         <span class="token number">33</span>:19:91:07:f2:86:cc:c7:e5:e3:02:d5:1d:b3:31:7d:cb:34:
         <span class="token number">16</span>:37:ab:e4:30:b0:34:0d:1d:b7:73:27:90:75:26:0f:4a:7f:
         <span class="token number">95</span>:9b:5c:13:a8:89:d3:8d:9b:a5:1a:33:4a:1e:b7:b4:1e:cd:
         a6:4f:5e:a9:89:27:f1:88:36:9f:3f:92:24:63:80:4b:5f:66:
         3d:14:91:21:1a:37:da:93:e5:86:56:cc:a6:8f:3e:4b:a8:57:
         aa:5e:62:bb:4c:8f:99:88:25:9c:a2:7c:f9:2a:94:e9:58:98:
         1b:aa:0e:e1:ad:22:af:68:e8:49:1d:14:21:fe:22:91:d3:0a:
         <span class="token number">99</span>:5a:c8:ad:89:bf:ac:9e:d5:b1:e7:35:67:8c:22:37:6d:2d:
         <span class="token number">85</span>:8d:45:2f:b4:c8:db:45:d4:79:e0:32:70:66:d3:32:fe:a7:
         5e:34:be:a0:5e:b6:54:97:d5:ad:5c:32:6d:f4:14:93:2a:95:
         <span class="token number">76</span>:57:d1:a2:d0:9b:de:15:09:2d:92:9e:13:85:75:5b:df:2e:
         c8:b4:eb:2f:fb:57:6e:ce:04:d2:6a:40:c2:5f:a8:a5:11:82:
         0d:0c:9b:65:96:1b:00:7d:25:d1:0e:5f:5f:bf:96:dc:54:8d:
         <span class="token number">22</span>:e9:8d:49:6a:3f:44:7b
 
 
<span class="token comment"># 使用 根证书链校验生成的服务端证书的正确性</span>
$ openssl verify -CAfile certs/rootca.cer newcerts/www.kubesre.com/server.cer
newcerts/www.kubesre.com/server.cer: OK
 
 
<span class="token comment"># 继续合并证书链, 当然你也可以选择不合并</span>
<span class="token comment"># 在服务端配置server端的证书时使用改证书链, 可以避免浏览器提示 `Windows没有足够信息, 不能验证该证书`</span>
<span class="token comment"># 但即便获取到完整的证书链, 依然会提示 `无法将这个证书验证到一个受信任的证书颁发机构`</span>
$ <span class="token function">cat</span> newcerts/www.kubesre.com/server.cer certs/rootca.cer  <span class="token operator">&gt;</span> newcerts/www.kubesre.com/server-chain.cer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br></div></div><h3 id="生成客户端证书"><a href="#生成客户端证书" class="header-anchor">#</a> 生成客户端证书</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 如下是生成客户端证书的步骤, 仔细看, 跟生成服务端证书没有差别</span>
<span class="token comment"># 证书都是正经一样的证书, 只是看你怎么用, 用在哪而已</span>
<span class="token comment"># 当然你也可以差异化的定制一些东西</span>
 
$ openssl genrsa -out newcerts/www.kubesre.com/client.key <span class="token number">2048</span>
$ openssl req -new -key newcerts/www.kubesre.com/client.key -out newcerts/www.kubesre.com/client.csr -subj <span class="token string">&quot;/C=CN/L=shanghai/O=kubesre/OU=ACS/CN=www.kubesre.com&quot;</span>
$ openssl x509 -req -extfile openssl.cnf -extensions usr_cert -days <span class="token number">365</span> -sha256 -CA certs/rootca.cer -CAkey private/rootca.key -CAserial serial -in newcerts/www.kubesre.com/client.csr -out newcerts/www.kubesre.com/client.cer
Signature ok
<span class="token assign-left variable">subject</span><span class="token operator">=</span>/C<span class="token operator">=</span>CN/L<span class="token operator">=</span>shanghai/O<span class="token operator">=</span>kubesre/OU<span class="token operator">=</span>ACS/CN<span class="token operator">=</span>www.kubesre.com
Getting CA Private Key
Enter pass phrase <span class="token keyword">for</span> private/rootca.key  <span class="token punctuation">(</span>输入CA私钥保护密码<span class="token punctuation">)</span>
$ openssl x509 -noout -text -in newcerts/www.kubesre.com/client.cer
Certificate:
    Data:
        Version: <span class="token number">3</span> <span class="token punctuation">(</span>0x2<span class="token punctuation">)</span>
        Serial Number: <span class="token number">4099</span> <span class="token punctuation">(</span>0x1003<span class="token punctuation">)</span>
    Signature Algorithm: sha256WithRSCNncryption
        Issuer: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>*.kubesre.com
        Validity
            Not Before: Dec <span class="token number">10</span> 07:20:14 <span class="token number">2020</span> GMT
            Not After <span class="token builtin class-name">:</span> Dec <span class="token number">10</span> 07:20:14 <span class="token number">2021</span> GMT
        Subject: <span class="token assign-left variable">C</span><span class="token operator">=</span>CN, <span class="token assign-left variable">L</span><span class="token operator">=</span>shanghai, <span class="token assign-left variable">O</span><span class="token operator">=</span>kubesre, <span class="token assign-left variable">OU</span><span class="token operator">=</span>ACS, <span class="token assign-left variable">CN</span><span class="token operator">=</span>www.kubesre.com
        Subject Public Key Info:
            Public Key Algorithm: rsCNncryption
                Public-Key: <span class="token punctuation">(</span><span class="token number">2048</span> bit<span class="token punctuation">)</span>
                Modulus:
                    00:c1:01:51:b3:14:e6:c9:18:b4:93:1d:3e:db:1a:
                    <span class="token number">12</span>:e9:3c:05:29:f5:ce:d2:ab:04:fc:25:50:6e:ef:
                    0c:0e:7c:42:ee:3c:82:7f:89:e5:d4:71:05:50:c6:
                    3e:97:61:2e:a2:54:93:CN:ac:02:f8:70:9d:76:2a:
                    3f:12:43:f7:b8:c6:a4:e4:a4:92:0c:4d:51:bc:15:
                    ce:d2:6c:5b:ab:7f:f5:79:78:CN:d2:79:a7:d3:0c:
                    e3:b4:02:20:28:0d:7d:bf:cc:3c:51:ed:b7:c3:2e:
                    <span class="token number">99</span>:70:ed:40:93:fc:da:54:de:b0:94:a0:7f:10:90:
                    6b:92:89:c3:08:2b:e5:5f:9a:bf:74:64:8f:ce:65:
                    df:a9:30:bc:a3:14:d7:90:50:ec:91:e9:4f:95:fe:
                    fa:be:91:50:bf:c1:bf:fe:e2:63:72:f6:51:30:41:
                    9c:6e:ec:c6:48:72:e1:d5:05:96:83:01:21:52:34:
                    f8:89:28:2c:9a:97:82:7e:e9:a0:7d:e2:0e:ec:ce:
                    9a:7f:6a:92:d9:85:38:9d:a7:86:b3:79:f6:5d:7a:
                    dc:80:bd:1d:0e:00:ff:65:64:56:d0:3b:6f:7b:8b:
                    08:a0:a6:15:d2:b4:ef:42:1c:1d:03:3b:CN:5a:93:
                    <span class="token number">30</span>:4b:c4:2d:53:aa:68:d4:c8:e2:6b:b2:ee:96:e6:
                    <span class="token number">44</span>:7b
                Exponent: <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
        X509v3 extensions:
            X509v3 Basic Constraints:
                CA:FALSE
            Netscape Comment:
                OpenSSL Generated Certificate
            X509v3 Subject Key Identifier:
                8E:8C:FE:DD:91:72:E7:04:13:C7:11:4D:60:2D:81:F4:3B:63:20:14
            X509v3 Authority Key Identifier:
                keyid:F4:DD:78:54:58:68:52:30:88:C1:AD:07:43:BD:14:2D:2D:09:E5:D1
 
    Signature Algorithm: sha256WithRSCNncryption
         <span class="token number">30</span>:30:f9:a8:ee:2f:83:4c:6b:3c:4e:0a:03:61:36:cd:92:44:
         b0:aa:49:55:1a:af:c7:79:08:a3:d2:a2:46:e2:23:2e:68:aa:
         2f:0e:cc:63:3b:a0:40:6a:69:86:b8:c6:8b:cc:f0:85:69:aa:
         <span class="token number">76</span>:53:ca:ab:28:de:fd:a7:4c:7f:33:4e:b4:1c:d8:82:b7:b0:
         de:50:d9:4c:25:a6:00:99:dc:8d:eb:79:c6:35:c1:7c:bb:f9:
         <span class="token number">19</span>:1f:3a:8a:44:29:42:03:c8:f5:31:88:6f:95:35:ab:d6:9d:
         <span class="token number">78</span>:71:c6:5c:61:3e:a0:7e:21:98:e8:5e:b4:66:07:90:a2:b8:
         e0:99:78:59:ab:62:f2:a7:76:97:53:0d:09:73:10:43:ac:70:
         <span class="token number">35</span>:df:d2:f5:dc:77:bc:99:8f:45:59:dc:15:25:5c:97:22:8c:
         a7:df:a8:f2:7f:28:5a:6f:90:fb:30:42:3d:60:27:c5:f2:bf:
         6d:21:ce:ef:f8:0e:43:c7:7d:83:21:65:b4:d7:2a:30:7c:0a:
         <span class="token number">12</span>:d1:f4:5f:3f:f6:9d:7b:ef:88:c5:bc:d3:10:b0:c0:51:2b:
         <span class="token number">55</span>:aa:eb:e4:2f:c1:a1:72:e6:4a:e5:ec:8b:71:62:4b:7b:48:
         5d:21:86:b5:fd:d4:d6:b7:98:9b:2e:54:c9:4a:a8:7b:45:71:
         <span class="token number">24</span>:5f:30:04:e0:6a:24:91:28:51:cf:00:63:07:a4:21:23:62:
         <span class="token number">70</span>:1b:d4:71:8b:e8:11:43:fb:c8:0c:46:8b:86:e6:58:e4:8e:
         5f:6f:d9:47:2d:87:df:14:f2:2d:81:b0:c6:1e:d5:ba:c3:63:
         5d:8c:2a:9b:df:d9:e1:26:4e:66:b2:4b:07:a9:9d:f3:e8:4c:
         fc:c3:97:62:57:d1:2b:15:06:e5:23:45:30:9a:2e:96:0d:6d:
         <span class="token number">62</span>:c1:a8:58:97:e6:cf:65:da:63:62:f5:c0:65:60:e8:1e:1a:
         3c:ce:32:aa:06:fb:44:d6:9f:bc:7a:21:e3:52:2c:53:4e:4a:
         d9:f0:a5:61:89:4b:89:5d:34:95:50:50:89:80:90:be:43:d0:
         c7:c4:88:7f:51:83:c8:90:9b:ef:e0:3b:07:c9:b0:14:59:1a:
         fb:71:14:49:be:31:09:a4:50:11:e1:f5:b3:4b:e0:98:6e:79:
         <span class="token number">97</span>:66:68:b0:73:b8:b2:b9:88:ab:5b:42:89:70:30:59:66:6c:
         3d:9f:e7:91:13:b5:21:ee:9f:16:a8:fc:87:2c:78:82:98:0e:
         ac:36:f2:6d:a1:e4:2a:97:21:23:73:d0:4e:a3:60:e8:b7:2d:
         b5:11:c5:ac:a9:e2:e7:cd:91:02:74:a2:69:85:4a:48:98:e0:
         <span class="token number">98</span>:0a:2c:ad:2f:19:a9:29
 
$ openssl verify -CAfile certs/rootca.cer newcerts/www.kubesre.com/client.cer
newcerts/www.kubesre.com/client.cer: OK
 
 
<span class="token comment"># 最后, 将客户端证书导出为 pkcs12 格式, 这样支持在PC一键安装</span>
$ openssl pkcs12 -export -clcerts -in newcerts/www.kubesre.com/client.cer -inkey newcerts/www.kubesre.com/client.key -out newcerts/www.kubesre.com/client.p12
Enter Export Password:   <span class="token punctuation">(</span>输入保护密码<span class="token punctuation">)</span>
Verifying - Enter Export Password:  <span class="token punctuation">(</span>输入确认保护密码<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br></div></div><h3 id="nginx服务端配置-服务端证书"><a href="#nginx服务端配置-服务端证书" class="header-anchor">#</a> Nginx服务端配置(服务端证书)</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>server <span class="token punctuation">{</span>
    listen <span class="token number">443</span> ssl<span class="token punctuation">;</span>
    server_name www.kubesre.com<span class="token punctuation">;</span>
    charset utf-8<span class="token punctuation">;</span>
 
    ssl_certificate     /root/ssl/newcerts/www.kubesre.com/server.cer<span class="token punctuation">;</span>   <span class="token comment"># 服务端证书</span>
    ssl_certificate_key /root/ssl/newcerts/www.kubesre.com/server.key<span class="token punctuation">;</span>    <span class="token comment"># 服务端私钥</span>
    ssl_session_timeout 5m<span class="token punctuation">;</span>
    ssl_ciphers ECDHE-RSA-CNS128-GCM-SHA256:ECDHE:ECDH:CNS:HIGH:<span class="token operator">!</span>NULL:<span class="token operator">!</span>aNULL:<span class="token operator">!</span>MD5:<span class="token operator">!</span>ADH:<span class="token operator">!</span>RC4<span class="token punctuation">;</span>
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2<span class="token punctuation">;</span>
    ssl_prefer_server_ciphers on<span class="token punctuation">;</span>
    ssl_verify_client on<span class="token punctuation">;</span>
    ssl_client_certificate /root/ssl/certs/rootca.cer<span class="token punctuation">;</span>     <span class="token comment"># CA根证书</span>
    ssl_verify_depth <span class="token number">2</span><span class="token punctuation">;</span>
     
    
   location / <span class="token punctuation">{</span>
         
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="通过curl命令验证双向认证"><a href="#通过curl命令验证双向认证" class="header-anchor">#</a> 通过Curl命令验证双向认证</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 如果访问正常，则双向认证验证成功！</span>
$ <span class="token function">curl</span> -v -s -k  --cacert ./ssl/certs/rootca.cer --key ./ssl/newcerts/www.kubesre.com/client.key --cert ./ssl/newcerts/www.kubesre.com/client.cer https://www.kubesre.com/
* About to connect<span class="token punctuation">(</span><span class="token punctuation">)</span> to www.kubesre.com port <span class="token number">443</span> <span class="token punctuation">(</span><span class="token comment">#0)</span>
*   Trying <span class="token number">192.168</span>.1.203<span class="token punctuation">..</span>.
* Connected to www.kubesre.com <span class="token punctuation">(</span><span class="token number">192.168</span>.1.203<span class="token punctuation">)</span> port <span class="token number">443</span> <span class="token punctuation">(</span><span class="token comment">#0)</span>
* Initializing NSS with certpath: sql:/etc/pki/nssdb
* skipping SSL peer certificate verification
* NSS: client certificate from <span class="token function">file</span>
*       subject: <span class="token assign-left variable">CN</span><span class="token operator">=</span>www.kubesre.com,OU<span class="token operator">=</span>ACS,O<span class="token operator">=</span>kubesre,L<span class="token operator">=</span>shanghai,C<span class="token operator">=</span>CN
*       start date: Dec <span class="token number">10</span> 07:20:14 <span class="token number">2020</span> GMT
*       expire date: Dec <span class="token number">10</span> 07:20:14 <span class="token number">2021</span> GMT
*       common name: www.kubesre.com
*       issuer: <span class="token assign-left variable">CN</span><span class="token operator">=</span>*.kubesre.com,OU<span class="token operator">=</span>ACS,O<span class="token operator">=</span>kubesre,L<span class="token operator">=</span>shanghai,C<span class="token operator">=</span>CN
* SSL connection using TLS_ECDHE_RSA_WITH_CNS_128_GCM_SHA256
* Server certificate:
*       subject: <span class="token assign-left variable">CN</span><span class="token operator">=</span>www.kubesre.com,OU<span class="token operator">=</span>ACS,O<span class="token operator">=</span>kubesre,L<span class="token operator">=</span>shanghai,C<span class="token operator">=</span>CN
*       start date: Dec <span class="token number">10</span> 07:09:35 <span class="token number">2020</span> GMT
*       expire date: Dec <span class="token number">10</span> 07:09:35 <span class="token number">2021</span> GMT
*       common name: www.kubesre.com
*       issuer: <span class="token assign-left variable">CN</span><span class="token operator">=</span>*.kubesre.com,OU<span class="token operator">=</span>ACS,O<span class="token operator">=</span>kubesre,L<span class="token operator">=</span>shanghai,C<span class="token operator">=</span>CN
<span class="token operator">&gt;</span> GET / HTTP/1.1
<span class="token operator">&gt;</span> User-Agent: curl/7.29.0
<span class="token operator">&gt;</span> Host: www.kubesre.com
<span class="token operator">&gt;</span> Accept: */*
<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span> HTTP/1.1 <span class="token number">200</span> OK
<span class="token operator">&lt;</span> Server: nginx/1.16.1
<span class="token operator">&lt;</span> Date: Thu, <span class="token number">10</span> Dec <span class="token number">2020</span> 08:00:34 GMT
<span class="token operator">&lt;</span> Content-Type: text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>utf-8
<span class="token operator">&lt;</span> Content-Length: <span class="token number">4833</span>
<span class="token operator">&lt;</span> Last-Modified: Fri, <span class="token number">16</span> May <span class="token number">2014</span> <span class="token number">15</span>:12:48 GMT
<span class="token operator">&lt;</span> Connection: keep-alive
<span class="token operator">&lt;</span> ETag: <span class="token string">&quot;53762af0-12e1&quot;</span>
<span class="token operator">&lt;</span> Accept-Ranges: bytes
<span class="token operator">&lt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE HTML PUBLIC <span class="token string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to CentOS<span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>style <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;text/css&quot;</span><span class="token operator">&gt;</span>
 
        html <span class="token punctuation">{</span>
        background-image:url<span class="token punctuation">(</span>img/html-background.png<span class="token punctuation">)</span><span class="token punctuation">;</span>
        background-color: white<span class="token punctuation">;</span>
        font-family: <span class="token string">&quot;DejaVu Sans&quot;</span>, <span class="token string">&quot;Liberation Sans&quot;</span>, sans-serif<span class="token punctuation">;</span>
        font-size: <span class="token number">0</span>.85em<span class="token punctuation">;</span>
        line-height: <span class="token number">1</span>.25em<span class="token punctuation">;</span>
        margin: <span class="token number">0</span> <span class="token number">4</span>% <span class="token number">0</span> <span class="token number">4</span>%<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        body <span class="token punctuation">{</span>
        border: 10px solid <span class="token comment">#fff;</span>
        margin:0<span class="token punctuation">;</span>
        padding:0<span class="token punctuation">;</span>
        background: <span class="token comment">#fff;</span>
        <span class="token punctuation">}</span>
 
        /* Links */
 
        a:link <span class="token punctuation">{</span> border-bottom: 1px dotted <span class="token comment">#ccc; text-decoration: none; color: #204d92; }</span>
        a:hover <span class="token punctuation">{</span> border-bottom:1px dotted <span class="token comment">#ccc; text-decoration: underline; color: green; }</span>
        a:active <span class="token punctuation">{</span>  border-bottom:1px dotted <span class="token comment">#ccc; text-decoration: underline; color: #204d92; }</span>
        a:visited <span class="token punctuation">{</span> border-bottom:1px dotted <span class="token comment">#ccc; text-decoration: none; color: #204d92; }</span>
        a:visited:hover <span class="token punctuation">{</span> border-bottom:1px dotted <span class="token comment">#ccc; text-decoration: underline; color: green; }</span>
  
        .logo a:link,
        .logo a:hover,
        .logo a:visited <span class="token punctuation">{</span> border-bottom: none<span class="token punctuation">;</span> <span class="token punctuation">}</span>
 
        .mainlinks a:link <span class="token punctuation">{</span> border-bottom: 1px dotted <span class="token comment">#ddd; text-decoration: none; color: #eee; }</span>
        .mainlinks a:hover <span class="token punctuation">{</span> border-bottom:1px dotted <span class="token comment">#ddd; text-decoration: underline; color: white; }</span>
        .mainlinks a:active <span class="token punctuation">{</span> border-bottom:1px dotted <span class="token comment">#ddd; text-decoration: underline; color: white; }</span>
        .mainlinks a:visited <span class="token punctuation">{</span> border-bottom:1px dotted <span class="token comment">#ddd; text-decoration: none; color: white; }</span>
        .mainlinks a:visited:hover <span class="token punctuation">{</span> border-bottom:1px dotted <span class="token comment">#ddd; text-decoration: underline; color: white; }</span>
 
        /* User interface styles */
 
        <span class="token comment">#header {</span>
        margin:0<span class="token punctuation">;</span>
        padding: <span class="token number">0</span>.5em<span class="token punctuation">;</span>
        background: <span class="token comment">#204D8C url(img/header-background.png);</span>
        text-align: left<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        .logo <span class="token punctuation">{</span>
        padding: <span class="token number">0</span><span class="token punctuation">;</span>
        /* For text only logo */
        font-size: <span class="token number">1</span>.4em<span class="token punctuation">;</span>
        line-height: 1em<span class="token punctuation">;</span>
        font-weight: bold<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        .logo img <span class="token punctuation">{</span>
        vertical-align: middle<span class="token punctuation">;</span>
        padding-right: 1em<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        .logo a <span class="token punctuation">{</span>
        color: <span class="token comment">#fff;</span>
        text-decoration: none<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        p <span class="token punctuation">{</span>
        line-height:1.5em<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        h1 <span class="token punctuation">{</span>
                margin-bottom: <span class="token number">0</span><span class="token punctuation">;</span>
                line-height: <span class="token number">1</span>.9em<span class="token punctuation">;</span> <span class="token punctuation">}</span>
        h2 <span class="token punctuation">{</span>
                margin-top: <span class="token number">0</span><span class="token punctuation">;</span>
                line-height: <span class="token number">1</span>.7em<span class="token punctuation">;</span> <span class="token punctuation">}</span>
 
        <span class="token comment">#content {</span>
        clear:both<span class="token punctuation">;</span>
        padding-left: 30px<span class="token punctuation">;</span>
        padding-right: 30px<span class="token punctuation">;</span>
        padding-bottom: 30px<span class="token punctuation">;</span>
        border-bottom: 5px solid <span class="token comment">#eee;</span>
        <span class="token punctuation">}</span>
 
    .mainlinks <span class="token punctuation">{</span>
        float: right<span class="token punctuation">;</span>
        margin-top: <span class="token number">0</span>.5em<span class="token punctuation">;</span>
        text-align: right<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    ul.mainlinks <span class="token operator">&gt;</span> li <span class="token punctuation">{</span>
    border-right: 1px dotted <span class="token comment">#ddd;</span>
    padding-right: 10px<span class="token punctuation">;</span>
    padding-left: 10px<span class="token punctuation">;</span>
    display: inline<span class="token punctuation">;</span>
    list-style: none<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    ul.mainlinks <span class="token operator">&gt;</span> li.last,
    ul.mainlinks <span class="token operator">&gt;</span> li.first <span class="token punctuation">{</span>
    border-right: none<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
  <span class="token operator">&lt;</span>/style<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>/head<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>div <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
 
    <span class="token operator">&lt;</span>ul <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;mainlinks&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://www.centos.org/&quot;</span><span class="token operator">&gt;</span>Home<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/&quot;</span><span class="token operator">&gt;</span>Wiki<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/GettingHelp/ListInfo&quot;</span><span class="token operator">&gt;</span>Mailing Lists<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://www.centos.org/download/mirrors/&quot;</span><span class="token operator">&gt;</span>Mirror List<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/irc&quot;</span><span class="token operator">&gt;</span>IRC<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;https://www.centos.org/forums/&quot;</span><span class="token operator">&gt;</span>Forums<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://bugs.centos.org/&quot;</span><span class="token operator">&gt;</span>Bugs<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;last&quot;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/Donate&quot;</span><span class="token operator">&gt;</span>Donate<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/ul<span class="token operator">&gt;</span>
 
        <span class="token operator">&lt;</span>div <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;logo&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://www.centos.org/&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">&quot;img/centos-logo.png&quot;</span> <span class="token assign-left variable">border</span><span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>div <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
 
        <span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Welcome to CentOS<span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
 
        <span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>The Community ENTerprise Operating System<span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
 
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://www.centos.org/&quot;</span><span class="token operator">&gt;</span>CentOS<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span> is an Enterprise-class Linux Distribution derived from sources freely provided
to the public by Red Hat, Inc. <span class="token keyword">for</span> Red Hat Enterprise Linux.  CentOS conforms fully with the upstream vendors
redistribution policy and aims to be functionally compatible. <span class="token punctuation">(</span>CentOS mainly changes packages to remove upstream vendor
branding and artwork.<span class="token punctuation">)</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
 
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>CentOS is developed by a small but growing team of core
developers.<span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> In turn the core developers are supported by an active user community
including system administrators, network administrators, enterprise users, managers, core Linux contributors and Linux enthusiasts from around the world.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
 
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>CentOS has numerous advantages including: an active and growing user community, quickly rebuilt, tested, and QA'ed errata packages, an extensive <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://www.centos.org/download/mirrors/&quot;</span><span class="token operator">&gt;</span>mirror network<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>, developers <span class="token function">who</span> are contactable and responsive, Special Interest Groups <span class="token punctuation">(</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/SpecialInterestGroup/&quot;</span><span class="token operator">&gt;</span>SIGs<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token punctuation">)</span> to <span class="token function">add</span> functionality to the core CentOS distribution, and multiple community support avenues including a <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/&quot;</span><span class="token operator">&gt;</span>wiki<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>a
<span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/irc&quot;</span><span class="token operator">&gt;</span>IRC Chat<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/GettingHelp/ListInfo&quot;</span><span class="token operator">&gt;</span>Email Lists<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;https://www.centos.org/forums/&quot;</span><span class="token operator">&gt;</span>Forums<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://bugs.centos.org/&quot;</span><span class="token operator">&gt;</span>Bugs Database<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>, and an <span class="token operator">&lt;</span>a
<span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://wiki.centos.org/FAQ/&quot;</span><span class="token operator">&gt;</span>FAQ<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
 
        <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
 
 
<span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span>
* Connection <span class="token comment">#0 to host www.kubesre.com left intact</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br></div></div><h2 id="openssl-自签-ecc-证书"><a href="#openssl-自签-ecc-证书" class="header-anchor">#</a> openssl 自签 ECC 证书</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 生成根私钥</span>
openssl ecparam -out private/ecc-rootca.key -name prime256v1 -genkey
<span class="token comment"># 生成根请求文件</span>
openssl req -key private/ecc-rootca.key -new -out private/ecc-rootca.req -subj <span class="token string">&quot;/C=CN/ST=shanghai/L=shanghai/O=kubesre/OU=IT/CN=*.kubesre.com&quot;</span>
<span class="token comment"># 通过根私钥生成根证书</span>
openssl x509 -req -in private/ecc-rootca.req -signkey private/ecc-rootca.key -out private/ecc-rootca.cer -days <span class="token number">36500</span>
<span class="token comment"># 通过根公私钥为csr颁发公钥证书</span>
openssl x509 -req -in csr/ECC_1610025387151.csr -CA private/ecc-rootca.cer  -CAkey private/ecc-rootca.key -out ECC_1610025387151.cer -CAcreateserial -days <span class="token number">7305</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-9354336437522810"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cf1998/kubernetes/edit/master/docs/_posts/Linux/openssl.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=SSL" title="标签">#SSL</a></div> <!----></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/acme01/"><div>acme.sh免费签发SSL证书</div></a> <span>12-20</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/k8s002/"><div>平滑升级Kubernetes集群(二进制)</div></a> <span>11-28</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/k8s001/"><div>Kubernetes 零宕机滚动更新</div></a> <span>11-27</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:995345781@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/cf1998" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2021
    <span>CloudNative Operations</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-9354336437522810"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.1e215306.js" defer></script><script src="/assets/js/2.f3cfc96e.js" defer></script><script src="/assets/js/29.1ad8b1c1.js" defer></script>
  </body>
</html>