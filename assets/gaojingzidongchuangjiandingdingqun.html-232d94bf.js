import { _ as _export_sfc, o as openBlock, c as createElementBlock, a as createStaticVNode } from "./app-53847742.js";
const _sfc_main = {};
const _hoisted_1 = /* @__PURE__ */ createStaticVNode('<h2 id="上篇回顾" tabindex="-1"><a class="header-anchor" href="#上篇回顾" aria-hidden="true">#</a> 上篇回顾</h2><p>上篇文章我们主要是针对告警认领进行了讲解，还有不了解的小伙伴可以添加最下方二维码进行交流。本篇文章参考阿里云企业级服务提出问题自动建群的功能进行对告警的一个补充。简单说就是当我们一个告警出现时，我们可以点击自动创建群聊来针对本次告警进行小群处理，处理过后可以解散该群(也可以触发解散)</p><h2 id="案例介绍" tabindex="-1"><a class="header-anchor" href="#案例介绍" aria-hidden="true">#</a> 案例介绍</h2><p>使用<code>gin</code>、<code>gorm</code>实现钉钉群的<code>crud</code>，钉钉outgoing机制触发建群接口。当第一次点击创建群时会自动创建群，当其他人再次点击创建群时，会自动拉其进入已经创建的群并更新告警认领，当我们解决完问题后，可以触发机器人对群内人员进行移除操作，当然该群目前还是会被保留。</p><h2 id="环境概述" tabindex="-1"><a class="header-anchor" href="#环境概述" aria-hidden="true">#</a> 环境概述</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># kubectl get nodes </span>\nNAME               STATUS   ROLES                  AGE   VERSION\nk8s-master-50.57   Ready    control-plane,master   96d   v1.20.5\nk8s-node-50.58     Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                 96d   v1.20.5\nk8s-node-50.59     Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                 96d   v1.20.5\n\n<span class="token comment"># kubectl get pod -n monitoring </span>\nNAME                                  READY   STATUS    RESTARTS   AGE\nalertmanager-main-0                   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          8d\nalertmanager-main-1                   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          8d\nalertmanager-main-2                   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          8d\nblackbox-exporter-55c457d5fb-5m7ql    <span class="token number">3</span>/3     Running   <span class="token number">0</span>          8d\ngrafana-9df57cdc4-gpzsq               <span class="token number">1</span>/1     Running   <span class="token number">0</span>          8d\nkube-state-metrics-56dbb74497-gpkn9   <span class="token number">3</span>/3     Running   <span class="token number">0</span>          8d\nnode-exporter-4wl6d                   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          8d\nnode-exporter-b4595                   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          8d\nnode-exporter-g4l99                   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          8d\nprometheus-adapter-59df95d9f5-tnt4w   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          8d\nprometheus-adapter-59df95d9f5-xhz5v   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          8d\nprometheus-k8s-0                      <span class="token number">2</span>/2     Running   <span class="token number">1</span>          8d\nprometheus-k8s-1                      <span class="token number">2</span>/2     Running   <span class="token number">1</span>          10m\nprometheus-operator-c46b8b7c9-mg9cv   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          8d\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>golang版本：1.17.10</li><li>gin版本：1.9.0</li><li>gorm版本：1.25.1</li></ul><h2 id="快速开始" tabindex="-1"><a class="header-anchor" href="#快速开始" aria-hidden="true">#</a> 快速开始</h2><ol><li><p>创建钉钉应用 <img src="https://img.kubesre.com/kubesre/20230831/1.png" alt=""></p></li><li><p>创建钉钉场景群模板 <img src="https://img.kubesre.com/kubesre/20230831/2.png" alt=""></p></li><li><p>场景群中添加机器人 <img src="https://img.kubesre.com/kubesre/20230831/3.png" alt=""></p></li><li><p>添加群插件 <img src="https://img.kubesre.com/kubesre/20230831/4.png" alt=""></p></li></ol><blockquote><p>群插件需要自己自行创建，当然也可以不使用插件</p></blockquote><ol start="5"><li>发布灰度进行测试 这里就不截图了，当然你也可以直接进行模板审核，只是审核时间比较长，大概需要一天左右</li></ol><h3 id="核心代码" tabindex="-1"><a class="header-anchor" href="#核心代码" aria-hidden="true">#</a> 核心代码</h3><ol><li>数据库字段设计</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> DingGroup <span class="token keyword">struct</span> <span class="token punctuation">{</span>\n	ID                 <span class="token builtin">uint</span>           <span class="token string">`gorm:&quot;primarykey&quot; json:&quot;id&quot; form:&quot;id&quot;`</span>\n	CreatedAt          time<span class="token punctuation">.</span>Time      <span class="token string">`gorm:&quot;column:creation_time&quot; json:&quot;created_at&quot; form:&quot;created_at&quot;`</span>\n	UpdatedAt          time<span class="token punctuation">.</span>Time      <span class="token string">`gorm:&quot;column:update_time&quot; json:&quot;updated_at&quot; form:&quot;updated_at&quot;`</span>\n	DeletedAt          gorm<span class="token punctuation">.</span>DeletedAt <span class="token string">`gorm:&quot;column:delete_time;index&quot; json:&quot;deleted_at&quot; form:&quot;deleted_at&quot;`</span>\n	Title              <span class="token builtin">string</span>         <span class="token string">`gorm:&quot;comment: &#39;群组名称&#39;;size:500;not null&quot; json:&quot;title&quot; form:&quot;title&quot;`</span>\n	ChatID             <span class="token builtin">string</span>         <span class="token string">`gorm:&quot;comment: &#39;群组ID&#39;;size:500;not null&quot; json:&quot;chat_id&quot; form:&quot;chat_id&quot;`</span>\n	OpenConversationID <span class="token builtin">string</span>         <span class="token string">`gorm:&quot;comment: &#39;群组唯一标识&#39;;size:500;not null;unique&quot; json:&quot;open_conversation_id&quot; form:&quot;open_conversation_id&quot;`</span>\n	UserIds            <span class="token builtin">string</span>         <span class="token string">`gorm:&quot;comment: &#39;群成员&#39;;type:text;not null&quot; json:&quot;user_ids&quot; form:&quot;user_ids&quot;`</span>\n	UUID               <span class="token builtin">string</span>         <span class="token string">`gorm:&quot;comment: &#39;告警UUID&#39;;size:500;not null;unique&quot; json:&quot;uuid&quot; form:&quot;uuid&quot;`</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>创建群聊接口</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>dg <span class="token operator">*</span>dingGroup<span class="token punctuation">)</span> <span class="token function">AddDingGroup</span><span class="token punctuation">(</span>userid<span class="token punctuation">,</span> text <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n	alertUUID <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">TrimSpace</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>\n	<span class="token comment">// 查询该告警数据</span>\n	alertData<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> db<span class="token punctuation">.</span>PrometheusAlert<span class="token punctuation">.</span><span class="token function">SelectPrometheusAlert</span><span class="token punctuation">(</span>alertUUID<span class="token punctuation">)</span>\n	<span class="token keyword">var</span> groupMsg <span class="token operator">=</span> model<span class="token punctuation">.</span>DingGroupRequestBody<span class="token punctuation">{</span>\n		Title<span class="token punctuation">:</span>                      alertData<span class="token punctuation">.</span>AlertName<span class="token punctuation">,</span>\n		TemplateID<span class="token punctuation">:</span>                 viper<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.templateID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		OwnerUserID<span class="token punctuation">:</span>                viper<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.ownerUserID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		UserIds<span class="token punctuation">:</span>                    alertData<span class="token punctuation">.</span>ClaimUsers<span class="token punctuation">,</span>\n		UUID<span class="token punctuation">:</span>                       alertData<span class="token punctuation">.</span>UUID<span class="token punctuation">,</span>\n		ShowHistoryType<span class="token punctuation">:</span>            viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.ShowHistoryType&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		ChatBannedType<span class="token punctuation">:</span>             viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.ChatBannedType&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		ManagementType<span class="token punctuation">:</span>             viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.ManagementType&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		OnlyAdminCanDing<span class="token punctuation">:</span>           viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.OnlyAdminCanDing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		AllMembersCanCreateMcsConf<span class="token punctuation">:</span> viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.AllMembersCanCreateMcsConf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		AddFriendForbidden<span class="token punctuation">:</span>         viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.AddFriendForbidden&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		GroupLiveSwitch<span class="token punctuation">:</span>            viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.GroupLiveSwitch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n		MembersToAdminChat<span class="token punctuation">:</span>         viper<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">&quot;dingGroup.MembersToAdminChat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n	<span class="token punctuation">}</span>\n	<span class="token keyword">var</span> <span class="token punctuation">(</span>\n		groupInfo     model<span class="token punctuation">.</span>DingGroup\n		groupResInfo  model<span class="token punctuation">.</span>DingGroupResponseBody\n		groupUserInfo model<span class="token punctuation">.</span>AddUserDingGroup\n	<span class="token punctuation">)</span>\n	groupInfo<span class="token punctuation">.</span>Title <span class="token operator">=</span> groupMsg<span class="token punctuation">.</span>Title\n	groupInfo<span class="token punctuation">.</span>UUID <span class="token operator">=</span> groupMsg<span class="token punctuation">.</span>UUID\n	groupInfo<span class="token punctuation">.</span>UserIds <span class="token operator">=</span> groupMsg<span class="token punctuation">.</span>UserIds\n	err<span class="token punctuation">,</span> group <span class="token operator">:=</span> db<span class="token punctuation">.</span>DingGroup<span class="token punctuation">.</span><span class="token function">AddDingGroup</span><span class="token punctuation">(</span>groupInfo<span class="token punctuation">)</span>\n	common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;该群已经创建过了哦&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> group<span class="token punctuation">)</span>\n	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">&quot;isExit&quot;</span> <span class="token punctuation">{</span>\n		common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;创建钉钉群失败了哦兄弟&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>\n		<span class="token keyword">return</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;创建钉钉群失败了哦兄弟&quot;</span><span class="token punctuation">)</span>\n	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> err <span class="token operator">==</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;isExit&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n		common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;该群已经存在了&quot;</span><span class="token punctuation">)</span>\n		<span class="token comment">// 该群已经存在,直接邀请入群，并更新群成员信息</span>\n		<span class="token comment">// 邀请入群</span>\n		groupUserInfo<span class="token punctuation">.</span>OpenConversationID <span class="token operator">=</span> group<span class="token punctuation">.</span>OpenConversationID\n		groupUserInfo<span class="token punctuation">.</span>UserIds <span class="token operator">=</span> userid\n		<span class="token comment">// 将数据库中用户列表转为切片</span>\n		<span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> DingSend<span class="token punctuation">.</span><span class="token function">AddUserDingGroup</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>groupUserInfo<span class="token punctuation">)</span>\n		<span class="token keyword">return</span> <span class="token boolean">nil</span>\n	<span class="token punctuation">}</span>\n	<span class="token comment">// 调用钉钉接口创建群</span>\n	common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;调用钉钉接口创建群&quot;</span><span class="token punctuation">)</span>\n	err<span class="token punctuation">,</span> data <span class="token operator">:=</span> DingSend<span class="token punctuation">.</span><span class="token function">CreateDingGroup</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>groupMsg<span class="token punctuation">)</span>\n	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>\n		common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;创建群失败了:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>\n		<span class="token keyword">return</span> err\n	<span class="token punctuation">}</span>\n	common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;创建钉钉群成功了哥哥&quot;</span><span class="token punctuation">)</span>\n	<span class="token boolean">_</span> <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>groupResInfo<span class="token punctuation">)</span>\n	<span class="token comment">// 更新群，添加管理员 chat_id  open_conversation_id</span>\n	groupInfo<span class="token punctuation">.</span>ChatID <span class="token operator">=</span> groupResInfo<span class="token punctuation">.</span>Result<span class="token punctuation">.</span>ChatID\n	groupInfo<span class="token punctuation">.</span>OpenConversationID <span class="token operator">=</span> groupResInfo<span class="token punctuation">.</span>Result<span class="token punctuation">.</span>OpenConversationID\n	err <span class="token operator">=</span> db<span class="token punctuation">.</span>DingGroup<span class="token punctuation">.</span><span class="token function">UpdateDingGroup</span><span class="token punctuation">(</span>groupInfo<span class="token punctuation">)</span>\n	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>\n		common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;更新钉钉群失败了&quot;</span><span class="token punctuation">)</span>\n		<span class="token keyword">return</span> err\n	<span class="token punctuation">}</span>\n	common<span class="token punctuation">.</span>TPLogger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;更新钉钉群成功了哥哥&quot;</span><span class="token punctuation">)</span>\n	<span class="token keyword">return</span> <span class="token boolean">nil</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>创建群所使用body</li></ol><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>\n        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;测试群&quot;</span><span class="token punctuation">,</span> # 群名称。\n        <span class="token property">&quot;template_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;c354***-***-***-b4ea-6f1ab***65&quot;</span><span class="token punctuation">,</span> # 群模板ID\n        <span class="token property">&quot;owner_user_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;022*****&quot;</span><span class="token punctuation">,</span> # 群主的userid。 \n        <span class="token property">&quot;user_ids&quot;</span><span class="token operator">:</span><span class="token string">&quot;072*****,013*****&quot;</span><span class="token punctuation">,</span> # 群成员userid列表。\n        <span class="token property">&quot;subadmin_ids&quot;</span><span class="token operator">:</span><span class="token string">&quot;072*****,013*****&quot;</span><span class="token punctuation">,</span> # 群管理员userid列表。\n        <span class="token property">&quot;uuid&quot;</span><span class="token operator">:</span><span class="token string">&quot;axcf*-*****-*****-23da*&quot;</span><span class="token punctuation">,</span> # 建群去重的业务ID，由接口调用方指定。\n        <span class="token property">&quot;icon&quot;</span><span class="token operator">:</span><span class="token string">&quot;@lADOADma*****QKA&quot;</span><span class="token punctuation">,</span> # 群头像，\n        <span class="token property">&quot;mention_all_authority&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # @all 权限： <span class="token number">0</span>（默认）：所有人都可以@all <span class="token number">1</span>：仅群主可@all\n        <span class="token property">&quot;show_history_type&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # 新成员是否可查看聊天历史消息：<span class="token number">0</span>（默认）：不可以查看历史记录  <span class="token number">1</span>：可以查看历史记录\n        <span class="token property">&quot;validation_type&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # 入群是否需要验证  <span class="token number">0</span>（默认）：不验证入群   <span class="token number">1</span>：入群验证\n        <span class="token property">&quot;searchable&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # 群是否可搜索  <span class="token number">0</span>（默认）：不可搜索  <span class="token number">1</span>：可搜索\n        <span class="token property">&quot;chat_banned_type&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # 是否开启群禁言  <span class="token number">0</span>（默认）：不禁言   <span class="token number">1</span>：全员禁言\n        <span class="token property">&quot;management_type&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>     # 管理类型 <span class="token number">0</span>（默认）：所有人可管理  <span class="token number">1</span>：仅群主可管理\n        <span class="token property">&quot;only_admin_can_ding&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # 群内发DING权限  <span class="token number">0</span>（默认）：所有人可发DING  <span class="token number">1</span>：仅群主和管理员可发DING\n        <span class="token property">&quot;all_members_can_create_mcs_conf&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> # 群会议权限 <span class="token number">0</span>：仅群主和管理员可发起视频和语音会议  <span class="token number">1</span>（默认）：所有人可发起视频和语音会议\n        <span class="token property">&quot;all_members_can_create_calendar&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # 群日历设置项，群内非好友/同事的成员是否可相互发起钉钉日程：  <span class="token number">0</span>（默认）：非好友/同事的成员不可发起钉钉日程  <span class="token number">1</span>：非好友/同事的成员可以发起钉钉日程\n        <span class="token property">&quot;group_email_disabled&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>  # 是否禁止发送群邮件： <span class="token number">0</span>（默认）：群内成员可以对本群发送群邮件  <span class="token number">1</span>：群内成员不可对本群发送群邮件\n        <span class="token property">&quot;only_admin_can_set_msg_top&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>  # 置顶群消息权限  <span class="token number">0</span>（默认）：所有人可置顶群消息  <span class="token number">1</span>：仅群主和管理员可置顶群消息\n        <span class="token property">&quot;add_friend_forbidden&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> # 群成员私聊权限  <span class="token number">0</span>（默认）：所有人可私聊  <span class="token number">1</span>：普通群成员之间不能够加好友、单聊，且部分功能使用受限（管理员与非管理员之间不受影响）\n        <span class="token property">&quot;group_live_switch&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>  #  群直播权限  <span class="token number">0</span>：仅群主与管理员可发起直播 <span class="token number">1</span>（默认）：群内任意成员可发起群直播\n        <span class="token property">&quot;members_to_admin_chat&quot;</span><span class="token operator">:</span><span class="token number">0</span>  # 是否禁止非管理员向管理员发起单聊： <span class="token number">0</span>（默认）：非管理员可以向管理员发起单聊  <span class="token number">1</span>：禁止非管理员向管理员发起单聊\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="触发告警" tabindex="-1"><a class="header-anchor" href="#触发告警" aria-hidden="true">#</a> 触发告警</h3><p><img src="https://img.kubesre.com/kubesre/20230831/5.png" alt=""></p><h3 id="点击自动创建-加入群聊" tabindex="-1"><a class="header-anchor" href="#点击自动创建-加入群聊" aria-hidden="true">#</a> 点击自动创建/加入群聊</h3><p><img src="https://img.kubesre.com/kubesre/20230831/6.png" alt=""></p><h3 id="查看当前群" tabindex="-1"><a class="header-anchor" href="#查看当前群" aria-hidden="true">#</a> 查看当前群</h3><p><img src="https://img.kubesre.com/kubesre/20230831/7.png" alt=""></p><blockquote><p>当前群中有自动添加的一个机器人prometheus，这是我们场景群模板中加入的，我们可以使用该群进行解散该群(只是移除除群主外的所有用于)，所以我们可以重新申请一个单独的钉钉用户，仅作为创建群使用</p></blockquote><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>自动创建群聊功能到此已经添加完成了，更多问题可以添加下方二维码一起交流，大佬云集期待与你的相遇。下期内容：告警排班</p>', 27);
const _hoisted_28 = [
  _hoisted_1
];
function _sfc_render(_ctx, _cache) {
  return openBlock(), createElementBlock("div", null, _hoisted_28);
}
const gaojingzidongchuangjiandingdingqun_html = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render], ["__file", "gaojingzidongchuangjiandingdingqun.html.vue"]]);
export {
  gaojingzidongchuangjiandingdingqun_html as default
};
