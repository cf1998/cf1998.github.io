(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{442:function(s,a,n){"use strict";n.r(a);var e=n(16),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v('QoS（Quality of Service），可译为 "服务质量等级"，或者译作 "服务质量保证"，是作用在 Pod 上的一个配置，当 Kubernetes 创建一个 Pod 时，它就会给这个 Pod 分配一个 QoS 等级。 Kubernetes使用Qos类来决定Pod的调度和驱逐策略。')]),s._v(" "),n("p",[n("img",{attrs:{src:"https://kubesre.com/img/kubernetes%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F%E7%AD%89%E7%BA%A7.jpg",alt:"img"}})]),s._v(" "),n("h2",{attrs:{id:"guaranteed"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#guaranteed"}},[s._v("#")]),s._v(" Guaranteed")]),s._v(" "),n("ul",[n("li",[s._v("Pod 中的每个容器，包含初始化容器，必须指定内存请求和内存限制，并且两者要相等。")]),s._v(" "),n("li",[s._v("Pod 中的每个容器，包含初始化容器，必须指定 CPU 请求和 CPU 限制，并且两者要相等。")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat qos-pod.yaml ")]),s._v("\napiVersion: v1\nkind: Pod\nmetadata:\n  name: qos-demo\nspec:\n  containers:\n  - name: qos-demo-ctr\n    image: nginx\n    resources:\n      limits:\n        memory: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200Mi"')]),s._v("\n        cpu: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"700m"')]),s._v("\n      requests:\n        memory: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200Mi"')]),s._v("\n        cpu: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"700m"')]),s._v("\n        \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f qos-pod.yaml ")]),s._v("\npod/qos-demo created\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl describe pod qos-demo | grep QoS")]),s._v("\nQoS Class:       Guaranteed\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("以上可以看出 Kubernetes 为 Pod 配置的 QoS 类为 Guaranteed")]),s._v(" "),n("blockquote",[n("p",[s._v("如果容器指定了自己的内存限制，但没有指定内存请求，Kubernetes 会自动为它指定与内存限制匹配的内存请求。 同样，如果容器指定了自己的 CPU 限制，但没有指定 CPU 请求，Kubernetes 会自动为它指定与 CPU 限制匹配的 CPU 请求。")])]),s._v(" "),n("h2",{attrs:{id:"burstable"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#burstable"}},[s._v("#")]),s._v(" Burstable")]),s._v(" "),n("ul",[n("li",[s._v("Pod 不符合 Guaranteed QoS 类的标准。")]),s._v(" "),n("li",[s._v("Pod 中至少一个容器具有内存或 CPU 请求。")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat qos-pod.yaml ")]),s._v("\napiVersion: v1\nkind: Pod\nmetadata:\n  name: qos-demo-2\nspec:\n  containers:\n  - name: qos-demo-2-ctr\n    image: nginx\n    resources:\n      limits:\n        memory: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200Mi"')]),s._v("\n      requests:\n        memory: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100Mi"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f qos-pod.yaml ")]),s._v("\npod/qos-demo-2 created\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl describe pod qos-demo | grep QoS")]),s._v("\nQoS Class:       Burstable\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("p",[s._v("以上可以看出 Kubernetes 为 Pod 配置的 QoS 类为  Burstable")]),s._v(" "),n("h2",{attrs:{id:"besteffort"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#besteffort"}},[s._v("#")]),s._v(" BestEffort")]),s._v(" "),n("ul",[n("li",[s._v("Pod 中的容器必须没有设置内存和 CPU 限制或请求")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat qos-pod.yaml ")]),s._v("\napiVersion: v1\nkind: Pod\nmetadata:\n  name: qos-demo-2\nspec:\n  containers:\n  - name: qos-demo-2-ctr\n    image: nginx\n    \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f qos-pod.yaml ")]),s._v("\npod/qos-demo-2 created\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl describe pod qos-demo | grep QoS")]),s._v("\nQoS Class:       BestEffort\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h2",{attrs:{id:"小结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),n("p",[s._v("QOS是K8S中的一种资源保护机制，其主要是针对不可压缩资源比如内存的一种控制技术。比如在内存中，其通过为不同的Pod和容器构造OOM评分，并且通过内核策略的辅助，从而实现当节点内存资源不足的时候，内核可以按照策略的优先级，优先kill掉那些优先级比较低（分值越高，优先级越低）的Pod。")]),s._v(" "),n("p",[s._v("优先级从高到低排序：")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("Guaranteed")])]),s._v(" "),n("li",[n("strong",[s._v("Burstable")])]),s._v(" "),n("li",[n("strong",[s._v("BestEffort")])])]),s._v(" "),n("h2",{attrs:{id:"参考文章"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://kubernetes.io/zh/docs/tasks/configure-pod-container/quality-service-pod/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://kubernetes.io/zh/docs/tasks/configure-pod-container/quality-service-pod/"),n("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=t.exports}}]);