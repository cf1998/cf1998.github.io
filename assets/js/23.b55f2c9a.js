(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{450:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),a("p",[s._v("Clickhouse 运行时会将一些个自身的运行状态记录到众多系统表中( system.*)。所以我 们对于 CH 自身的一些运行指标的监控数据，也主要来自这些系统表。\n"),s._v("\n但是直接查询这些系统表会有一些不足之处")]),s._v(" "),a("ul",[a("li",[s._v("这种方式太过底层，不够直观，我们还需要在此之上实现可视化展示")]),s._v(" "),a("li",[s._v("系统表只记录了CH自己的运行指标，有些时候我们需要外部系统的指标进行关联分析，列如ZooKeeper、服务器 CPU、IO 等等。")])]),s._v(" "),a("p",[s._v("现在 Prometheus + Grafana 的组合比较流行，安装简单易上手，可以集成很多框架，包")]),s._v(" "),a("p",[s._v("括服务器的负载, 其中 Prometheus 负责收集各类系统的运行指标; Grafana 负责可视化的")]),s._v(" "),a("p",[s._v("部分。")]),s._v(" "),a("p",[s._v("ClickHouse 从 v20.1.2.4 开始，内置了对接 Prometheus 的功能，配置的方式也很简单,")]),s._v(" "),a("p",[s._v("可以将其作为 Prometheus 的 Endpoint 服务，从而自动的将 metrics 、 events 和")]),s._v(" "),a("p",[s._v("asynchronous_metrics 三张系统的表的数据发送给 Prometheus。")]),s._v(" "),a("h2",{attrs:{id:"clickhouse-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clickhouse-配置"}},[s._v("#")]),s._v(" "),a("strong",[s._v("ClickHouse")]),s._v(" "),a("strong",[s._v("配置")])]),s._v(" "),a("p",[s._v("编辑/etc/clickhouse-server/config.xml，打开如下配置：")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("prometheus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("endpoint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("/metrics"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("endpoint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("9363"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("metrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("true"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("metrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("events")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("true"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("events")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("asynchronous_metrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("true"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("asynchronous_metrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("status_info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("true"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("status_info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("prometheus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("重启Clickhouse")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl restart clickhouse-server\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"prometheus-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-安装"}},[s._v("#")]),s._v(" Prometheus 安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 基础环境准备")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看系统版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("  /etc/redhat-release\nCentOS Linux\nrelease "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.7")]),s._v(".1908 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n \n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看系统内核")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -r\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-1062.18.1.el7.x86_64\n \n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装目录")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),s._v("\n/application/prometheus\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据存储目录")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),s._v("\n/application/data/prometheus_data\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 安装Prometheus")]),s._v("\n \n \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载prometheus安装包")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/prometheus/prometheus/releases/download/v2.20.0/prometheus-2.20.0.linux-amd64.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压安装包")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzvf prometheus-v2.20.0.linux-amd64.tar.gz\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" prometheus-v2.20.0.linux-amd64 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/prometheus\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建启动用户")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" prometheus\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -g prometheus -s /sbin/nologin prometheus\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建prometheus存储目录并授权")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /application/data/prometheus_data\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R prometheus.prometheus prometheus_data/\n\n**prometheus.yml配置文件说明**\n \nglobal:\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认情况下，每15s拉取一次目标采样点数据。")]),s._v("\n  scrape_interval:     15s\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我们可以附加一些指定标签到采样点度量标签列表中, 用于和第三方系统进行通信, 包括：federation, remote storage, Alertmanager")]),s._v("\n  external_labels:\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面就是拉取自身服务采样点数据配置")]),s._v("\n    monitor: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'codelab-monitor'")]),s._v("\nscrape_configs:\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# job名称会增加到拉取到的所有采样点上，同时还有一个instance目标服务的host：port标签也会增加到采样点上")]),s._v("\n  - job_name: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'prometheus'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 覆盖global的采样点，拉取时间间隔5s")]),s._v("\n    scrape_interval: 5s\n    static_configs:\n      - targets: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost:9090'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      \n  - job_name: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ck'")]),s._v("\n    static_configs:\n    - targets: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.1.104:9363'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n \n \n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建Prometheus系统服务并启动")]),s._v("\n \n \n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/systemd/system/prometheus.service\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("prometheus\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("After")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("network.target\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("simple\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("prometheus\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/application/prometheus/prometheus --config.file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/application/prometheus/prometheus.yml --storage.tsdb.path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/application/data/prometheus_data --web.enable-lifecycle\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("on-failure\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("multi-user.target\n \n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注释")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定配置文件")]),s._v("\n--config.file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus.yml"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定监听地址端口")]),s._v("\n--web.listen-address"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0:9090"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最大连接数")]),s._v("\n--web.max-connections"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tsdb数据存储的目录，默认当前data/")]),s._v("\n--storage.tsdb.path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data/"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# premetheus 存储数据的时间，默认保存15天")]),s._v("\n--storage.tsdb.retention"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("15d\n \n$ systemctl start prometheus\n$ systemctl status prometheus\n$ systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" prometheus\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br")])]),a("h2",{attrs:{id:"grafana-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grafana-安装"}},[s._v("#")]),s._v(" Grafana 安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -P /usr/local/src https://dl.grafana.com/oss/release/grafana-7.1.2-1.x86_64.rpm  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载安装包")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/src\n$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y grafana-7.1.2-1.x86_64.rpm\n$ /etc/init.d/grafana-server start   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动grafana服务")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 登录访问")]),s._v("\n访问：http://192.168.1.110:3000，默认账号/密码：admin/admin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"grafana-集成-prometheus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grafana-集成-prometheus"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Grafana")]),s._v(" "),a("strong",[s._v("集成")]),s._v(" "),a("strong",[s._v("Prometheus")])]),s._v(" "),a("h3",{attrs:{id:"添加数据源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加数据源"}},[s._v("#")]),s._v(" 添加数据源")]),s._v(" "),a("p",[s._v("点击配置，点击 Data Sources：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-1.jpg",alt:""}})]),s._v(" "),a("p",[s._v("点击添加按钮：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-2.jpg",alt:""}})]),s._v(" "),a("p",[s._v("找到 Prometheus，点击 Select")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-3.jpg",alt:""}})]),s._v(" "),a("p",[s._v("配置 Prometheus Server 地址：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-4.jpg",alt:""}})]),s._v(" "),a("p",[s._v("点击下方的 Save&Test,出现绿色的提示框，表示与 Prometheus 正常联通")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-5.jpg",alt:""}})]),s._v(" "),a("p",[s._v("点击 Back 返回即可，可以看到 Data Sources 页面，出现了添加的 Prometheus:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-6.jpg",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"添加监控面板"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加监控面板"}},[s._v("#")]),s._v(" 添加监控面板")]),s._v(" "),a("p",[s._v("点击左侧 ”+”号，选择 import：")]),s._v(" "),a("p",[s._v("https://kubesre.com/img/ck/clickhouse-metrics-on-settings_rev1.json")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-6.jpg",alt:""}})]),s._v(" "),a("p",[s._v("展示监控：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://kubesre.com/img/ck/ck-8.jpg",alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);